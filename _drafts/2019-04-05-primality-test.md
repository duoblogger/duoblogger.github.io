---
layout: post
title: Primality Test
mathjax: true
author: Munim Hasan Wasi
tags: [Concrete Mathematics]
Difficulty: Beginner
mathjax: true
ads_niche: 0
subtitle: এই আর্টিকেলটি মৌলিক সংখ্যা যাচাই করার ওরফে প্রাইমালিটি টেস্ট করার বিভিন্ন কৌশল নিয়ে রচিত। এখানে আমি বর্গমূল পর্যন্ত সব সংখ্যা দিয়ে ভাগ করা, ফার্মার উপপাদ্য ব্যবহার করে প্রাইমালিটি টেস্ট ও মিলার-র‍্যাবিন প্রাইমালিটি টেস্ট নিয়ে আলোচনা করবো। 
# permalink: /прималити-тест/
# background: '/img/somehow.png'
categories: [Number Theory, Primes, Math]
---

<h3> পরিচয়পর্ব </h3>

মৌলিক সংখ্যা কী সেটা আমরা কমবেশি সবাই জানি। মৌলিক সংখ্যা হচ্ছে এমন সব ধনাত্মক পূর্ণসংখ্যা যাদের ঠিক দুটি উৎপাদক আছে। এই আর্টিকেলটিতে একটি সংখ্যা মৌলিক কিনা তা যাচাই করার বিভিন্ন পদ্ধতি নিয়ে আলোচনা করব।

<h3> ট্রায়াল ডিভিশন পদ্ধতি </h3>

মৌলিক সংখ্যার সংজ্ঞানুসারে এর 1 এবং সংখ্যাটি নিজে বাদে আর কোন উৎপাদক নেই। একটি যৌগিক সংখ্যার কমপক্ষে একটি অতিরিক্ত উৎপাদক থাকবেই। ধরি এটি $$d$$। যদি $$n$$ এর উৎপাদক $$d$$ হয় তাহলে $$\frac{n}{d}$$ ও এর উৎপাদক হবে। এ উৎপাদকদ্বয় এর উভয়ই সমান হবে যদি $$n$$ পূর্ণবর্গ হয়। তখন উৎপাদক দুটি হবে $$\sqrt n$$। কিন্তু যদি এরা সমান না হয় তাহলে এদের মধ্যে একটি $$\sqrt n $$ এর চেয়ে ছোট হবে এবং অন্যটি $$\sqrt n $$ এর চেয়ে বড় হবে। তাই সকল মৌলিক সংখ্যার একটি হলেও উৎপাদক $$1 ‌< d \leq \sqrt n$$  হবে। তাই আমরা $$2$$ থেকে শুরু করে $$\sqrt n$$ পর্যন্ত সবগুলো সংখ্যা দিয়ে $$n$$ এর বিভাজ্যতা পরীক্ষা করব। যদি এর মধ্যে কোন একটি সংখ্যা দিয়ে $$n$$ নিঃশেষে বিভাজ্য হয় তাহলে $$n$$ যৌগিক, এবং কোন সংখ্যা দিয়েই ভাগ না গেলে $$n$$ মৌলিক। 

```c++
bool isPrime(int x) {
    for (int d = 2; d * d <= x; d++) {
        if (x % d == 0)
            return false;
    }
    return true;
}
```

উপরের ইম্প্লিমেন্টেশনটি মৌলিক সংখ্যা যাচাই করার সবচেয়ে সরল উপায়। এটিকে কিছু ছোটখাটো পরিবর্তন করার মাধ্যমে কিছুটা অপটিমাইজ করা যায়।  এর একটি উদাহরণ হতে পারে 2 কে আলাদা ভাবে চেক করে শুধু বেজোড় সংখ্যা গুলো দিয়ে বিভাজ্যতা পরীক্ষা করা। 

<h3> ফার্মার প্রাইমালিটি টেস্ট </h3>

এটি একটি প্রবাবিলিস্টিক টেস্ট।

ফার্মার লিটল উপপাদ্য থেকে আমরা পাই যে, একটি মৌলিক সংখ্যা $$p$$ এবং এর একটি সহমৌলিক সংখ্যা $$a$$ এর জন্য নিম্নোক্ত সমীকরণটি সর্বদা সত্য হবে।

​														$$ a^{p-1} \equiv 1 $$ $$(mod$$ $$p)$$ $$--------- (1) $$

এই সমীকরণটি সাধারণত যৌগিক সংখ্যার জন্য মিথ্যা হয়।

এই সমীকরণটিকে একটি প্রাইমালিটি টেস্ট হিসেবে ব্যবহার করা যায়। ধরি, আমাদের যাচাই করতে হবে $$p$$ মৌলিক নাকি যৌগিক। আমরা যে কোন একটি পূর্ণসংখ্যা $$ 2 \leq a \leq p-2 $$  নিব এবং যাচাই করব যে $$(1)$$ সমীকরণটি এই $$a$$ এবং $$p$$ জন্য সত্য হয় কিনা।  যদি এটা সত্য না হয়, অর্থাৎ $$ a^{p-1} \not\equiv 1 $$ $$(mod$$ $$p)$$, আমরা জানি যে $$p$$ মৌলিক নয়। এক্ষেত্রে বেস $$a$$ কে $$p$$ এর যোগিক সংখ্যা হওয়ার ফার্মার উইটনেস বলা হয়।


কিন্তু এখানে একটি ছোট সমস্যা আছে। এই সমীকরণটি একটি মৌলিক সংখ্যার জন্য সর্বদা সত্য হলেও, কোনো একটি যৌগিক সংখ্যার জন্য সর্বদা মিথ্যা হবেই এমন কোনো কথা নেই। তাই যদিও সমীকরণটি মিথ্যা হলেই আমরা বলতে পারি যে $$p$$ অবশ্যই যৌগিক কিন্তু যদি এই সমীকরণটি সত্য হয় তাহলে আমরা নিশ্চিত ভাবে বলতে পারি না যে $$p$$ মৌলিক। আমরা বলতে পারি যে এটি সম্ভবত মৌলিক। যদি বেস $$a$$ এর জন্য $$1$$ সমীকরণটি সত্য হওয়ার পরেও এটি যৌগিক সংখ্যা হয় তাহলে আমরা বেসটিকে ফার্মার লায়ার বলি।

সকল বেস $$ 2 \leq a \leq p-2 $$ এর জন্য চেক করে আমরা এটা প্রমাণ করতে পারি যে সংখ্যাটি আসলেই মৌলিক। কিন্তু ব্যবহারিক ক্ষেত্রে এটি করা হয় না কারণ এতে অনেক সময় ব্যয় হয়। বরং দৈব চয়ন এর মাধ্যমে কয়েকটি বেস এর জন্য যাচাই করেই আমরা মোটামুটি নিশ্চিত হতে পারি। যদি কোনো ফার্মার উইটনেস না পাওয়া যায় তাহলে বলা যায় যে এটি মৌলিক হওয়া সম্ভাবনাই বেশি।

```c++
bool probablyPrimeFermat(int n, int iter=5) {
    if (n < 4)
        return n == 2 || n == 3;

    for (int i = 0; i < iter; i++) {
        int a = 2 + rand() % (n - 3);
        if (binpower(a, n - 1, n) != 1)
            return false;
    }
    return true;
}
```

আমরা বাইনারি এক্সপোনেনশিয়াল ব্যবহার করে খুব এফিশিয়েন্টলি $$a^{p-1}$$ গণনা করতে পারি।


তবে একটি খারাপ খবর আছে: এমন কিছু যৌগিক সংখ্যা আছে যাদের সব সহমৌলিক বেস $$a$$ এর জন্যই  $$ a^{n-1} \equiv 1 $$ $$(mod$$ $$n)$$ সত্য হয়। এসব সংখ্যা কে <a href="https://en.wikipedia.org/wiki/Carmichael_number">কারমাইকেল নাম্বার</a> বলা হয়। ফার্মার প্রাইমালিটি টেস্টে এ নাম্বার গুলোকে তখনই যাচাই করতে পারে যদি আমাদের ভাগ্য খুব ভালো হয় এবং আমরা এমন একটি বেস খুঁজে পাই যেটি $$n$$ এর সাথে সহমৌলিক নয়।

তাও ফার্মার উপপাদ্য টি ব্যবহারিক ক্ষেত্রে প্রয়োগ করা হয় কারণ এটি খুবই এফিশিয়েন্ট এবং কারমাইকেল নাম্বার খুবই দুষ্প্রাপ্য। $$10^9$$ এর নিচে মাত্র $$646$$ টি কারমাইকেল নাম্বার রয়েছে। 