I"tD<h3><font color="#4459c9"> Introduction </font></h3>
<p>ржзрж░рж┐ ржЖржорж╛ржжрзЗрж░ ржПржХржЯрж┐ рж╕рзНржЯрзНрж░рж┐ржВ $s$ ржжрзЗржпрж╝рж╛ ржЖржЫрзЗред рж╕рзНржЯрзНрж░рж┐ржВржЯрж┐рж░ ржжрзИрж░рзНржШрзНржп $|s|$ ржУржЗ рж╕рзНржЯрзНрж░рж┐ржВ $s$ ржПрж░ ржЬржирзНржп $z$-ржлрж╛ржВрж╢ржи рж╣ржЪрзНржЫрзЗ ржПржХржЯрж┐ $|s|$ рж╕рж╛ржЗржЬрзЗрж░ ржЕрзНржпрж╛рж░рзЗ, ржпрзЗржЦрж╛ржирзЗ $i$ рждржо ржЙржкрж╛ржжрж╛ржи $z[i]$ рж╣ржЪрзНржЫрзЗ ржПржХржЯрж╛ рж╕рзНржмрж╛ржнрж╛ржмрж┐ржХ рж╕ржВржЦрзНржпрж╛, ржпрзЗржЯрж╛ ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рзЗ $s$ ржПрж░ $i$ рждржо ржЗржиржбрзЗржХрзНрж╕ ржерзЗржХрзЗ рж╢рзБрж░рзБ ржХрж░рзЗ рж╕рж░рзНржмрзЛржЪрзНржЪ ржХржд ржмржбрж╝ <a href="https://en.wikipedia.org/wiki/Substring#Substring">рж╕рж╛ржмрж╕рзНржЯрзНрж░рж┐ржВ</a> ржирзЗржУржпрж╝рж╛ ржпрж╛ржмрзЗ ржпрзЗржи рж╕рзЗржЯрж╛ $s$ ржПрж░ <a href="https://en.wikipedia.org/wiki/Substring#Prefix">ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕</a> рж╣ржпрж╝ред</p>

<p>ржПржЗ ржЖрж░рзНржЯрж┐ржХрзЗрж▓ржЯрж┐рждрзЗ ржЖржорж┐ ржнрзЗржЬрж╛рж▓ ржПрзЬрж╛ржирзЛрж░ ржЙржжрзНржжрзЗрж╢рзНржпрзЗ рж╕ржмржХрж┐ржЫрзБрж░ ржЬржирзНржп $0$-ржмрзЗрж╕ржб ржЗржирзНржбрзЗржХрзНрж╕ ржзрж░рзЗ ржирж┐ржм ред</p>

<p>$z$-ржлрж╛ржВрж╢ржирзЗрж░ ржкрзНрж░ржержо ржЙржкрж╛ржжрж╛ржи ржПрж░ ржмрзНржпрж╛ржкрж╛рж░рзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рзЗ ржХрж┐ржЫрзБ ржирзЗржЗред ржПржЯрж╛ рждрзЗржоржи ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржХрж┐ржЫрзБ ржиржпрж╝ред ЁЯШХ ржХрж╛рж░ржг рж╢рзВржирзНржп ржерзЗржХрзЗ рж╢рзБрж░рзБ ржХрж░рж▓рзЗ ржкрзБрж░рзЛржЯрж╛ рж╕рзНржЯрзНрж░рж┐ржВржпрж╝рзЗрж░ ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ ржПрж░ рж╕рж╛ржерзЗ рж╕рж░рзНржмржжрж╛ ржорзНржпрж╛ржЪ ржХрж░ржмрзЗред ржЖржорж░рж╛ ржПржЦрж╛ржирзЗ $z[0] =0 $ ржзрж░рзЗ ржирж┐рждрзЗ ржкрж╛рж░рж┐ред
ржПржЗ ржЖрж░рзНржЯрж┐ржХрзЗрж▓рзЗ  ржЖржорж┐  $z$-ржлрж╛ржВрж╢ржи $O(n)$ ржХржорзНржкрзНрж▓рзЗржХрзНрж╕рж┐ржЯрж┐ рждрзЗ ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯ ржХрж░рж╛рж░  ржЕрзНржпрж╛рж▓ржЧрж░рж┐ржжржо ржУ ржжрзЗржЦрж╛ржмрзЛред</p>

<h3> <font color="#4459c9"> Examples </font> </h3>
<p>ржЙржжрж╛рж╣рж░ржг рж╣рж┐рж╕рзЗржмрзЗ, ржирж┐ржЪрзЗ ржХрж┐ржЫрзБ рж╕рзНржЯрзНрж░рж┐ржВ ржПрж░ $z$-ржлрж╛ржВрж╢ржирзЗрж░ рж╕ржмржЧрзБрж▓рзЛ ржорж╛ржи ржмрзЗрж░ ржХрж░рзЗ ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛ: ЁЯША</p>

<ul>
  <li>тАЬ$aaaaa$тАЭ - $[0,4,3,2,1]$</li>
  <li>тАЬ$aaabaab$тАЭ - $[0,2,1,0,2,1,0]$</li>
  <li>тАЬ$abacaba$тАЭ - $[0,0,1,0,3,0,1]$</li>
</ul>

<h3> <font color="#4459c9"> Trivial Algorithm </font> </h3>
<p>ржбрзЗржлрж┐ржирзЗрж╢ржи ржерзЗржХрзЗ ржЪрж╛ржЗрж▓рзЗ ржирзБржмрзЗрж░ ржорждрзЛ $O(n^2)$ ржХрзЛржб рж▓рж┐ржЦрзЗ ржлрзЗрж▓рж╛ ржпрж╛рзЯред ЁЯШТ</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">z_function_trivial</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">s</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">z</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="o">++</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">z</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ржЖржорж░рж╛ рж╢рзБржзрзБ ржкрзНрж░рждрж┐ржЯрж╛ ржкржЬрж┐рж╢ржи $i$ ржПрж░ ржЬржирзНржп рж▓рзБржк ржЪрж╛рж▓рж┐рзЯрзЗ ржпрждржХрзНрж╖ржг рж╕рзНржЯрзНрж░рж┐ржВржЯрж┐рж░ ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕рзЗрж░ рж╕рж╛ржерзЗ ржорж┐рж▓рждрзЗ ржерж╛ржХржмрзЗ рждрждржХрзНрж╖ржг ржкрж░рзНржпржирзНржд $z[i]$  ржПрж░ ржорж╛ржи ржмрж╛рзЬрж╛рждрзЗ ржерж╛ржХржмрзЛред  ржПржЯрж╛ ржЕржмрж╢рзНржпржЗ ржлрж╛рж▓рждрзБ ржПржХржЯрж╛ ржЕрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржоред ржПржЗ ржЯрж╛ржЗржо ржХржорзНржкрзНрж▓рзЗржХрзНрж╕рж┐ржЯрж┐рж░ ржЪрзЗрзЯрзЗ ржЕржирзЗржХ ржнрж╛рж▓рзЛржнрж╛ржмрзЗ $z$-ржлрж╛ржВрж╢ржи ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯ ржХрж░рж╛ ржпрж╛рзЯред ржПржмрж╛рж░ ржЖржорж░рж╛ рж╕рзЗржЯрж╛ ржжрзЗржЦржмрзЛред ЁЯШН</p>

<h3> <font color="#4459c9"> Efficient algorithm to compute the Z-function </font> </h3>
<p>ржПржХржЯрж╛ ржПржлрж┐рж╢рж┐рзЯрзЗржирзНржЯ ржЕрзНржпрж╛рж▓ржЧрж░рж┐ржжржо рждрзИрж░рж┐ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ $z[i]$ ржПрж░ ржорж╛ржиржЧрзБрж▓рзЛ $i=1$ ржерзЗржХрзЗ $n-1$ ржкрж░рзНржпржирзНржд ржХржорзНржкрж┐ржЙржЯ ржХрж░ржмрзЛред ржХрж┐ржирзНрждрзБ  ржЖржорж░рж╛ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржм ржЖржЧрзЗрж░ ржХржорзНржкрж┐ржЙржЯ ржХрж░рж╛ ржорж╛ржиржЧрзБрж▓рзЛ ржХрзЗ ржпрждржЯрж╛ рж╕ржорзНржнржм ржХрж╛ржЬрзЗ рж▓рж╛ржЧрж╛ржирзЛрж░ред</p>

<p>ржЭрж╛ржорзЗрж▓рж╛ ржПржбрж╝рж╛ржирзЛрж░ ржЬржирзНржп ржЖржорж░рж╛ тАЬрж╕рзЗржЧржорзЗржирзНржЯ ржорзНржпрж╛ржЪтАЭ  ржмрж▓рждрзЗ ржУржЗ рж╕рж╛ржмрж╕рзНржЯрзНрж░рж┐ржВ ржЧрзБрж▓рзЛржХрзЗ ржмрзБржЭрж╛ржмрзЛ ржпрзЗржЧрзБрж▓рзЛ $s$ ржПрж░ ржХрзЛржи ржПржХржЯрж┐ ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ ржПрж░ рж╕рж╛ржерзЗ ржорзНржпрж╛ржЪ ржХрж░рзЗред ржпрзЗржоржи, $z$-ржлрж╛ржВрж╢ржирзЗрж░ ржнрзНржпрж╛рж▓рзБ $z[i]$ рж╣ржЪрзНржЫрзЗ ржУржЗ рж╕рзЗржЧржорзЗржирзНржЯ ржорзНржпрж╛ржЪрзЗрж░ ржжрзИрж░рзНржШрзНржп ржпрж╛ $i$ рждрзЗ рж╢рзБрж░рзБ ржПржмржВ $i+z[i]-1$ ржП рж╢рзЗрж╖ред</p>

<p>ржПржЯрж╛ ржХрж░рж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ $l$ ржУ $r$ рж░рж╛ржЦржмрзЛ ржпрзЗржЗ $[l:r]$ рж░рзЗржЮрзНржЬржЯрж┐ ржирж┐рж░рзНржжрзЗрж╢ ржХрж░ржмрзЗ $r$ ржП рж╢рзЗрж╖ ржПржоржи ржПржХржЯрж┐ рж╕рзЗржЧржорзЗржирзНржЯ ржорзНржпрж╛ржЪ $l$ ржП рж╢рзБрж░рзБред ржЖрж░рзЗржХржнрж╛ржмрзЗ $r$ ржПржХржЯрж╛ ржмрж╛ржЙржирзНржбрж╛рж░рж┐ рж╣рж┐рж╕рзЗржмрзЗ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ ржпрзЗржЯрж╛ ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рзЗ ржпрзЗ ржПрждрзЛржЯрзБржХрзБ ржкрж░рзНржпржирзНржд ржЖржорж╛ржжрзЗрж░ ржХрж╛ржЬ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржПрж░ ржкрж░рзЗрж░ рж╕ржмржХрж┐ржЫрзБ ржПржЦржирзЛ ржкрж░рзНржпржирзНржд ржЖржорж╛ржжрзЗрж░ ржЕржЬрж╛ржирж╛ред</p>

<p>ржПржЦржи, ржоржирзЗ ржХрж░рж┐ ржЖржорж░рж╛ $i$ рждржо ржЗржиржбрзЗржХрзНрж╕рзЗ ржЖржЫрж┐ред  ржПржЦржи ржЖржорж╛ржжрзЗрж░ $z[i]$ ржПрж░ ржорж╛ржи ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯ ржХрж░рждрзЗ рж╣ржмрзЗред ржПржХрзНрж╖рзЗрждрзНрж░рзЗ ржжрзБржЯрж┐ ржХрзЗрж╕ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред</p>

<ul>
  <li>
    <p>$i&gt;r$ тАУ ржмрж░рзНрждржорж╛ржи ржЗржиржбрзЗржХрзНрж╕ржЯрж┐ ржЖржорж░рж╛ ржпрждржЯрзБржХрзБ ржкрж░рзНржпржирзНржд ржкрзНрж░рж╕рзЗрж╕ ржХрж░рзЗржЫрж┐ ржПрж░ ржмрж╛ржЗрж░рзЗред
ржПржХрзНрж╖рзЗрждрзНрж░рзЗ ржЖржорж░рж╛ ржЯрзНрж░рж┐ржнрж┐ржпрж╝рж╛рж▓ ржПрж▓ржЧрж░рж┐ржжржо ржПрж░ ржорждржЗ ржЬрж╛рж╕рзНржЯ рж▓рзБржк ржЪрж╛рж▓рж┐ржпрж╝рзЗ ржПржХржЯрж┐ ржПржХржЯрж┐ ржХрж░рзЗ ржнрзНржпрж╛рж▓рзБ ржЪрзЗржХ ржХрж░рждрзЗ ржерж╛ржХржмрзЛред  ржПржЦрж╛ржирзЗ ржПржЗ ржЬрж┐ржирж┐рж╕ржЯрж╛ ржЦрзЗржпрж╝рж╛рж▓ рж░рж╛ржЦрждрзЗ рж╣ржмрзЗ ржпрзЗ ржЖржорж╛ржжрзЗрж░ $r$ ржПрж░ ржорж╛ржи ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╣ржмрзЗ ржХрж╛рж░ржг ржПржЯрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржпрзЗ $r$ ржПрж░ ржмрж░рзНрждржорж╛ржи ржорж╛ржи ржЖржЧрзЗрж░ $r$ ржПрж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╣ржмрзЗред</p>
  </li>
  <li>
    <p>$ i \leq r$ тАУ  ржмрж░рзНрждржорж╛ржи ржкржЬрж┐рж╢ржиржЯрж╛ ржЖржорж░рж╛ ржпрждржЯрзБржХрзБ ржкрзНрж░рж╕рзЗрж╕ ржХрж░рзЗржЫрж┐ ржПрж░ ржнрж┐рждрж░ред
ржПржЦржи ржЖржорж░рж╛ ржЖржЧрзЗрж░ ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯ ржХрж░рж╛ $z[]$ ржПрж░ ржорж╛ржи ржЧрзБрж▓рзЛрж░ рж╕рж╛рж╣рж╛ржпрзНржпрзЗ $z[i]$ рждрзЗ ржХрзЛржи ржПржХржЯрж╛ ржорж╛ржи ржПрж╕рж╛ржЗржи ржХрж░ржм ред рждрж╛рж░ржкрж░ ржЖржорж░рж╛ ржУржЗ ржорж╛ржи ржерзЗржХрзЗ ржХрж╛ржЬ ржХрж░рж╛ рж╢рзБрж░рзБ ржХрж░ржмред ржПржЯрж╛ ржЕржмрж╢рзНржпржЗ $0$ ржерзЗржХрзЗ ржХрж╛ржЬ рж╢рзБрж░рзБ ржХрж░рж╛рж░ ржЪрзЗржпрж╝рзЗ ржнрж╛рж▓рзЛред ржЖржорж░рж╛ ржПржХржЯрзБ ржЦрзЗржпрж╝рж╛рж▓ ржХрж░рж▓рзЗржЗ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЛ ржпрзЗ $s[lтАжтАж.r]$ ржПржмржВ $s[0тАжтАж.r-l]$ ржХрж┐ржирзНрждрзБ ржкрзБрж░рзЛржкрзБрж░рж┐ ржорзНржпрж╛ржЪ ржХрж░ржмрзЗред ржПржЯрж╛ ржХрзЗржи рж╣ржмрзЗ ржПржЯрж╛  ржЖржорж░рж╛ ржХрж┐ржЫрзБржЯрж╛ ржЪрж┐ржирзНрждрж╛ ржХрж░рж▓рзЗржЗ ржмрзБржЭрждрзЗ ржкрж╛рж░ржмред</p>

    <p>$[0,  r-l]$ ржЕржВрж╢ржЯрж┐рж░ $z$-ржнрзЗрж▓рзБ ржЖржЧрзЗ ржерзЗржХрзЗржЗ ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯ ржХрж░рж╛ ржЖржЫрзЗред рждрж╛ржЗ ржЖржорж░рж╛ ржЪрж╛ржЗрж▓рзЗ $z[i]$ ржПрж░ ржнрзНржпрж╛рж▓рзБ рж╣рж┐рж╕рзЗржмрзЗ $z[i-l]$ ржХрзЗ ржзрж░рзЗ ржирж┐рждрзЗ ржкрж╛рж░рж┐ред</p>

    <p>ржХрж┐ржирзНрждрзБ ржПржЦрж╛ржирзЗ ржПржХржЯрж┐ ржмрж┐рж╖ржпрж╝ ржЖржЫрзЗ,  $z[i-l]$ ржПрж░ ржорж╛ржи ржЕржирзЗржХ ржмржбрж╝ рж╣ржпрж╝рзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред  ржпрзЗ рж╕рзЗржЯрж╛ ржпржжрж┐ $i$ ржПрж░ $z$-ржнрзНржпрж╛рж▓рзБ рж╣ржпрж╝ рждрж╛рж╣рж▓рзЗ рждрж╛ $i$ ржПрж░ рж╕рж╛ржерзЗ ржпрзБржХрзНржд ржХрж░рж▓рзЗ $r$ ржПрж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝ред ржХрж┐ржирзНрждрзБ ржЖржорж░рж╛ $r$ ржПрж░ ржбрж╛ржи ржПрж░ ржорж╛ржи ржЧрзБрж▓рзЛ рж╕ржорзНржкрж░рзНржХрзЗ ржХрж┐ржЫрзБржЗ ржЬрж╛ржирж┐ржирж╛ред ржПржЯрж┐ ржорж┐рж▓рждрзЗ ржкрж╛рж░рзЗ, ржирж╛ржУ ржорж┐рж▓рждрзЗ ржкрж╛рж░рзЗред рждрж╛ржЗ ржЖржорж░рж╛ $z[i]$ ржПрж░ ржорж╛ржи ржПржд ржмрзЗрж╢рж┐ ржирж┐рждрзЗ ржкрж╛рж░ржм ржирж╛ ржпрзЗ рждрж╛ ржмрж░рзНрждржорж╛ржи ржкржЬрж┐рж╢ржи ржПрж░ рж╕рж╛ржерзЗ ржпрзБржХрзНржд ржХрж░рж▓рзЗ $r$ ржмрзЗрж╢рж┐ рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝ ржЕрж░рзНржерж╛рзО $i+z[i] &gt; r$ рж╣рзЯрзЗ ржпрж╛рзЯред 
ржПржХржЯрж┐ ржЙржжрж╛рж╣рж░ржг рж╣рждрзЗ ржкрж╛рж░рзЗ ржПржоржи:</p>

    <p>тАЛ												$s =$ тАЬ$ aaaabaa$тАЭ</p>

    <p>ржпржЦржи ржЖржорж░рж╛ рж╢рзЗрж╖рзЗрж░ ржЖржЧрзЗрж░ ржкржЬрж┐рж╢ржирзЗ ржкрзМржБржЫрж╛ржм $(i=6)$,  ржЖржорж░рж╛ ржжрзЗржЦрждрзЗ ржкрж╛ржЪрзНржЫрж┐ ржпрзЗ ржмрж░рзНрждржорж╛ржи рж╕рзЗржЧржорзЗржирзНржЯ ржорзНржпрж╛ржЪ рж╣ржЪрзНржЫрзЗ $[5:6]$, $6$ ржкржЬрж┐рж╢ржиржЯрж┐ рждрж╛рж╣рж▓рзЗ $6-5=1$ ржПрж░ рж╕рж╛ржерзЗ ржорзНржпрж╛ржЪ ржХрж░ржмрзЗ ржпрзЗржЯрж╛рж░ $z$-ржлрж╛ржВрж╢ржирзЗрж░ ржорж╛ржи рж╣ржЪрзНржЫрзЗ $z[1]=3$ред ржЕржмрж╢рзНржпржЗ ржЖржорж░рж╛ $z[6]$ ржП $3$ ржПрж╕рж╛ржЗржи ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржирж╛ ржХрж╛рж░ржи рждрж╛рж╣рж▓рзЗ ржПржЯрж╛ рж╕ржорзНржкрзВрж░рзНржг ржнрзБрж▓ рж╣ржмрзЗред рж╕рж░рзНржмрзЛржЪрзНржЪ ржпрзЗ ржнрзНржпрж╛рж▓рзБ ржЖржорж░рж╛ ржирж┐рждрзЗ ржкрж╛рж░рж┐ рж╕рзЗржЯрж╛ рж╣ржЪрзНржЫрзЗ 1ред  ржХрж╛рж░ржг ржПржЯрж╛ржЗ рж╕рж░рзНржмрзЛржЪрзНржЪ ржорж╛ржи ржпрзЗржЯрж╛ ржирж┐рж▓рзЗржУ $i+z[i]$ ржПрж░ ржорж╛ржи $r$ ржкрж╛рж░ рж╣ржмрзЗ ржирж╛ред рждрж╛ржЗ ржкрзНрж░рж╛ржержорж┐ржХржнрж╛ржмрзЗ ржЖржорж░рж╛ $z[i]$ ржПрж░ ржорж╛ржирзЗ ржирж┐рж╢рзНржЪрж┐ржд ржнрж╛ржмрзЗ ржПржЯрж╛ ржирж┐рждрзЗ ржкрж╛рж░рж┐:</p>

    <p>тАЛ									$z[i] = min(r-i+1, z[i-l])$</p>

    <p>ржкрзНрж░рж╛ржержорж┐ржХржнрж╛ржмрзЗ ржорж╛ржи ржмрж╕рж╛ржирзЛрж░ ржкрж░ ржЖржорж░рж╛ ржЯрзНрж░рж┐ржнрж┐рзЯрж╛рж▓ ржЕрж▓ржЧрзЛрж░рж┐ржжржорзЗрж░ ржорждрзЛ рж▓рзБржк ржЪрж╛рж▓рж┐ржпрж╝рзЗ ржЪрзЗржХ ржХрж░ржм рждрж╛рж░ржкрж░ ржЖрж░ ржХрждржЯрзБржХрзБ ржорзНржпрж╛ржЪ ржХрж░рзЗред</p>
  </li>
</ul>

<p>рждрж╛ржЗ ржПржЗ ржЕрзНржпрж╛рж▓ржЧрж░рж┐ржжржо ржЯрж╛ ржорзВрж▓ржд ржжрзБржЗ ржнрж╛ржЧрзЗ ржмрж┐ржнржХрзНржд,  ржпрзЗржЧрзБрж▓рзЛ рж╢рзБржзрзБ $z[i]$ ржПрж░ ржкрзНрж░рж╛ржержорж┐ржХ ржорж╛ржи ржХржд рж╣ржмрзЗ рж╕рзЗржЯрж╛ ржжрж┐ржпрж╝рзЗ ржЖрж▓рж╛ржжрж╛ред ржкрзНрж░ржержо ржХрзЗрж╕ ржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржЖржорж░рж╛ ржкрзНрж░рж╛ржержорж┐ржХ ржорж╛ржи рж╣рж┐рж╕рзЗржмрзЗ 0 ржзрж░рзЗ ржирзЗржЗред ржжрзНржмрж┐рждрзАржпрж╝ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржЖржорж░рж╛ ржкрзВрж░рзНржмржмрж░рзНрждрзА ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯ ржХрж░рж╛ ржорж╛ржиржЧрзБрж▓рзЛ ржХрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рзЗ ржПржХржЯрж┐ ржнрзНржпрж╛рж▓рзБ ржПрж╕рж╛ржЗржи ржХрж░рж┐ред рждрж╛рж░ржкрж░ ржЖржорж░рж╛ ржЙржнржпрж╝ ржХрзНрж╖рзЗрждрзНрж░рзЗржЗ ржЯрзНрж░рж┐ржнрж┐ржпрж╝рж╛рж▓ ржЕрзНржпрж╛рж▓ржЧрж░рж┐ржжржо ржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржмрж╛ржХрж┐ ржорж╛ржиржЧрзБрж▓рзЛ ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯ ржХрж░рж┐ред</p>

<p>ржХржорзНржкрзНрж▓рзЗржХрзНрж╕рж┐ржЯрж┐ рждрзБрж▓ржирж╛ржпрж╝ ржЕрзНржпрж╛рж▓ржЧрж░рж┐ржжржоржЯрж┐ ржЖрж╕рж▓рзЗ ржЦрзБржмржЗ рж╕рж░рж▓. ржПржЦржи ржЕржирзЗржХрзЗрж░ ржоржирзЗ рж╕ржирзНржжрзЗрж╣ ржЬрж╛ржЧрждрзЗ ржкрж╛рж░рзЗ ржпрзЗ ржЖржорж░рж╛ ржкрзНрж░рждрж┐ржЯрж┐ ржЗржирзНржбрзЗржХрзНрж╕ ржПрж░ ржЬржирзНржп ржЯрзНрж░рж┐ржнрж┐рзЯрж╛рж▓ ржЕрзНржпрж╛рж▓ржЧрж░рж┐ржжржо ржЪрж╛рж▓рж╛рж▓рж╛ржо, рждрж╛рж╣рж▓рзЗ ржХржорзНржкрзНрж▓рзЗржХрзНрж╕рж┐ржЯрж┐ рж▓рж┐ржирж┐ржпрж╝рж╛рж░ рж╣рж▓рзЛ ржХрж┐ржнрж╛ржмрзЗред ржЖржорж░рж╛ ржЗржорзНржкрзНрж▓рзЗржорзЗржирзНржЯрзЗрж╢ржи ржПрж░ ржкрж░рзЗржЗ ржПржЯрж╛рж░ ржкрзНрж░ржорж╛ржг ржжрзЗржЦржм ред</p>

<h3> <font color="#4459c9"> Implementation </font> </h3>
<p>ржЕрзНржпрж╛рж▓ржЧрзЛрж░рж┐ржжржорзЗрж░ ржкрж┐ржЫржирзЗрж░ ржЖржЗржбрж┐рзЯрж╛рзЯ рждрзБрж▓ржирж╛рзЯ ржЗржорзНржкрзНрж▓рж┐ржорзЗржиржЯрзЗрж╢ржи ржЦрзБржмржЗ ржЫрзЛржЯ</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">z_function</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">s</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">z</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span>
            <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">l</span><span class="p">]);</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="o">++</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">z</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
:ET